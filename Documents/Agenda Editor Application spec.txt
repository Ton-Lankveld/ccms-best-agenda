Calender Editor Application spec

Author: Ton van Lankveld
Version: 2015-10-25


PURPOSE
An application to show and manage the Calender page, for the public and members site of www.ccms-best.nl .


FLOW
The editor can only be accessed via the members site.
You have to login to open the editor.
Build static HTML Editor page.
The dynamic part of the page, in the browser, is done with JavaScript.
Load ccms-agenda.json from server.
Build meetings table with:
- list of meetings with Edit and Delete buttons
- Buttons Add Meetings and Undo
If you click on the Delete button, the row of this meeting will be deleted from the list.
If you click on the Edit or Add Meeting button, the fields of the (new) meeting are shown.
    For every meeting you can select a workgroup.
        Every workgroup has a contact person.
        Load group-contact.json
    After the list is changed, this list is sorted on date-time.
If you click the Save/Insert button, the list is stored on the server as: ccms-agenda.json.
If you click on Undo button, ccms-agenda.json loaded from server
    Only one undo step possible
Close Editor page
Copy (with ftp?) file to public site.


SERVER SIDE
OPTION 1
    Program language: PHP 5.x
    Filename: ccms-agenda-editor.php
    Send Login page to browser
    Wait for login data
        Time-out after 120 seconds
    Check login data
        If login data not correct --> wait 2 seconds and send login page again to browser
    Set session token
    Remember date-time of ccms-agenda.json
    Send Agenda Editor page, without meeting table, to user
    Check date-time of ccms-agenda.json every second
    If date-time changed: (received ccms-agenda.json by httprequest (AJAX))
        Sanatize and validate ccms-agenda.json
        Sort agenda on date-time
    If error(s) ...
    Date-time of ccms-agenda.json did not change in 10 minutes:
        Stop script
OPTION 2
    Filename: ccms-agenda-editor.html, without meeting table


BROWSER SIDE
Program language: JavaScript
If JavaScript is not enabled --> message: "If you want to see the agenda, please enable JavaScript in your browser."
Filename: ccms-agenda-editor.js
Check for ccms-agenda.json and group-contact.json
    If file(s) not found --> message: "Can not find agenda or contact file. Can not show agenda."
Load ccms-agenda.json
Load group-contact.json
Insert meetings table
Watch buttons
If Delete button is pressed:
	Delete meeting row from HTML agenda table
	Delete meeting from JSON data
	Rebuild HTML agenda table
	Send JSON file to server (AJAX)
	If Undo button is disabled:
	    Enable Undo button
If Edit button is pressed:
	Find requested meeting in JSON data
	Show edit/add form, with Save button
	Fill edit/add form with data of requested meeting
	See: Add Meeting button
If Add Meeting button is pressed:
	Show edit/add form, with Insert button
	The user adds data to a field
	Sanatize and validate data
	If Group or Contact fields are selected:
		Make selection list from group-contact.json
		If group/contact is selected fill contact/group and e-mail field with data
	If Save/Insert button is pressed:
		Add new/edited meeting to JSON data
		Sort data on date-time
		Rebuild HTML agenda table
		Send JSON file to server (AJAX)
		If Undo button is disabled:
	        Enable Undo button
If Undo button is pressed:
	Get JSON file from server
	Rebuild HTML agenda table
	Disable Undo button
